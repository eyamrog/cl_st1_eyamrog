A flawless bacterial genome assembly is characterized by an exact match between the assembled sequence and the organism's genome, ensuring that each replicon sequence is complete and devoid of errors. While achieving this level of perfection has historically posed challenges, advancements in long-read sequencing, assemblers, and polishers have made perfect assemblies more attainable. In this study, we outline our recommended methodology for achieving a flawless bacterial genome assembly, utilizing a combination of Oxford Nanopore Technologies long reads and Illumina short reads. Our approach involves Trycycler long-read assembly, Medaka long-read polishing, Polypolish short-read polishing, and subsequent short-read polishing tools with manual curation. Additionally, we address potential pitfalls that may arise during the assembly of complex genomes and offer an online tutorial complete with sample data, accessible at github.com/rrwick/perfect-bacterial-genome-tutorial.
This research received support from the Bill & Melinda Gates Foundation (KEH, grant number OPP1175797) and an Australian Government Research Training Program Scholarship (RRW). The Foundation's grant conditions entail a Creative Commons Attribution 4.0 Generic License for the Author Accepted Manuscript version resulting from this submission. The funders did not participate in the study's design, data collection and analysis, decision to publish, or manuscript preparation.
In comparison to eukaryotes, which possess complex genomes often exceeding one billion base pairs (bp) in length, prokaryote genomes are relatively small, typically comprising a single circular chromosome a few million bp in length along with small extrachromosomal plasmids. In numerous genomic applications, having access to the complete bacterial genome sequence, encompassing the full sequence of nucleotides for each DNA fragment in the cell, would be highly advantageous. However, the process of DNA sequencing involves fragmenting the genome and sequencing these fragments, resulting in reads that are randomly ordered small segments of the genome. These reads are inherently imperfect, with the frequency and type of errors varying based on the sequencing platform used. Moreover, they are redundant, as generating reads that collectively exceed the genome size multiple times is essential to ensure comprehensive coverage of the genome. This creates a disparity between the output provided by sequencers (small, imperfect, redundant sequences) and the desired outcome (a complete, error-free genome).
The resolution to this issue lies in de novo assembly, a computational procedure aimed at reconstructing a genome from sequencing reads. Genome assembly revolves around two primary objectives: accuracy and completeness. Accuracy pertains to the presence of errors within the assembled sequences (contigs), which can range from minor errors like incorrect bases to major errors such as the addition or removal of hundreds of bases. Completeness, on the other hand, refers to the length of the contigs in relation to the corresponding genomic sequence, indicating how fragmented the assembly is. Ideally, longer contigs are preferred, with each contig ideally representing an entire replicon in the genome. A 'perfect' assembly is one that optimizes both accuracy and completeness, where a flawless assembly of a bacterial genome would consist of a single error-free contig per replicon without any additional contigs.
Numerous downstream analyses may not necessitate high-quality assemblies; for instance, one can discern the species of a genome or determine the presence/absence of a gene using a basic assembly. However, certain tasks demand utmost precision, such as estimating mutation rates and inferring transmission chains, where even minor errors can yield significant consequences. Flawless assemblies present boundless opportunities for downstream applications, rendering the question of 'is my assembly good enough?' irrelevant. In the absence of assembly errors, numerous analyses that involve directly interrogating reads (employing computationally intensive methods like variant calling) could potentially be substituted with simpler assembly-based alternatives.
In this study, we present a contemporary method for generating a bacterial genome assembly with the aim of achieving perfection by utilizing a combination of Oxford Nanopore Technologies (ONT) long reads and Illumina short reads (Figure 1). These platforms were selected due to their accessibility and widespread use in microbial genomics. While previous hybrid assembly techniques have typically employed a short-read-first strategy (constructing a short-read assembly graph and then using long reads for scaffolding), recent advancements in the output and precision of long-read sequencing have made a long-read-first hybrid assembly approach (creating a long-read-only assembly and subsequently refining it with short reads) more effective in producing accurate outcomes. This manuscript adopts the latter approach. Additionally, we offer an online tutorial (github.com/rrwick/perfect-bacterial-genome-tutorial) featuring sample data (hybrid sequencing of Staphylococcus aureus strain JKD61596) to enable readers to experiment with this methodology themselves.
To minimize genomic heterogeneity, DNA extraction from a single bacterial colony is essential. The method for DNA extraction may vary depending on the organism, but the goal should be to achieve high purity and molecular weight. High purity is crucial for optimal ONT yields, as impurities can damage nanopores and shorten flow cell lifespan. Similarly, high molecular weight leads to longer ONT reads, necessitating precautions such as avoiding vortexing, minimizing handling and pipetting, and reducing freeze-thaw cycles to prevent DNA shearing. For most bacteria, cell lysis through enzymatic digestion is recommended, involving lysozyme followed by proteinase K digestion from DNA extraction kits. While this method suits Gram-negative and Gram-positive bacteria, additional enzymes may be necessary for challenging-to-lyse bacteria. Magnetic bead-based DNA extraction is advised to minimize shearing and enhance throughput, with recommended kits being GenFind V3 and MagAttract HMW DNA. In cases where enzymatic lysis is difficult, bead-beating can be an alternative, although it may compromise ONT read length.
If culturing and DNA extraction are performed multiple times, such as once for ONT sequencing and again for Illumina sequencing, there is a potential for genomic discrepancies between the DNA samples. These disparities can pose challenges during the polishing process, underscoring the importance of utilizing a single DNA extract for all sequencing runs. Additionally, it is advisable to store extra DNA or bacterial pellets in a frozen state to accommodate any future sequencing needs that may arise.
One crucial factor to consider in ONT sequencing is the depth of the reads: how deep should the ONT read set be? A higher read depth is beneficial for both assembly, allowing for more independent read sets in Trycycler (refer to Step 3), and polishing, resulting in higher accuracy (refer to Step 4). When striving for a flawless assembly, it is advisable to aim for a minimum depth of 100×, with 200× being considered ideal. Depths exceeding 200× are advantageous but may yield diminishing returns. Utilizing a single ONT flow cell for a single bacterial isolate could lead to excessive depth, hence multiplexing is a common practice in microbial genomics. While this does not pose a problem for assembly, it is important to consider barcode leakage (refer to Pitfalls).
Another important factor to consider is the length of the ONT reads. N50 length serves as a widely utilized metric, representing the length-weighted median. To achieve a comprehensive assembly, it is crucial that the read set possesses an N50 length surpassing that of the longest repeat sequence. In the context of numerous bacterial genomes, such as the rRNA operon, which typically spans around 5 kbp and is commonly found in multiple copies, aiming for an ONT read N50 of approximately 20 kbp is deemed a suitable objective. In exceptional scenarios where the genome harbors an unusually lengthy repeat, necessitating ultra-long DNA extraction protocols, may be required as highlighted in the section on Pitfalls.
ONT library preparation, chemistry, and basecalling play crucial roles in bacterial whole-genome sequencing. Both ligation-based and rapid preparations are suitable, with ligation-based methods typically enhancing sequencing yield and rapid preparations favoring read length. Currently, ONT provides MinION/GridION flow cells featuring two distinct pores: R9.4.1 (introduced in 2017) and R10.4.1 (launched in 2022). The R10.4.1 flow cells utilize longer pores, enhancing homopolymer resolution and consensus accuracy, making them the preferred choice for assembly. Basecalling, the computational process of converting raw signals from the sequencer into nucleotide sequences, is continuously evolving. Therefore, users are advised to utilize the latest version of ONT's recommended basecaller and its highest-accuracy model. For users lacking an ONT sequencer with a GPU, such as a GridION, access to a computer equipped with a GPU is necessary for performing basecalling.
Following basecalling, the quality of ONT reads can be enhanced through QC filtering. It is advisable to utilize Filtlong15 for the elimination of subpar reads characterized by short length and low accuracy, employing the parameter --keep_percent 90. In cases where the read set exhibits a deficient N50 but possesses significant depth, the exclusion of short reads (e.g. <5 kbp) can aid in the assembly process, albeit potentially impacting the recovery of small plasmids, as discussed in the section on Pitfalls.
Illumina reads, designated for final polishing in Step 5, hold less significance compared to ONT reads. Presently, most Illumina platforms yield similar data, such as 150-bp paired-end reads, suitable for bacterial whole-genome sequencing, with instrument selection influenced by cost and multiplexing requirements. Notably, Nextera XT library preparations exhibit variable read depth, potentially resulting in regions of the genome with low depth, making Illumina DNA Prep (Nextera DNA Flex) and TruSeq more favorable options. When utilizing Nextera XT, it is advisable to target a high mean depth (e.g. 300×) to counterbalance depth fluctuations; otherwise, 100× may suffice. For genomes with high repetition, mate-pair preparations could enhance short-read polishing efficacy (refer to Pitfalls). Following the generation of Illumina reads, it is recommended to employ a QC tool like fastp to eliminate low-quality bases and adapter sequences.
The objective of long-read assembly is to generate accurate sequences devoid of structural errors. Ideally, the assembly should only contain minor errors such as single-base substitutions, insertions, or deletions. These small-scale errors can be rectified during subsequent polishing stages; however, larger structural errors may be more challenging to correct.
Several long-read assemblers have been developed for bacterial genomes, such as Canu18, Flye19, NECAT20, NextDenovo21, and Raven22, each employing distinct methods with their own set of advantages and disadvantages. Despite the assembler chosen, most long-read bacterial genome assemblies tend to contain preventable errors, and when utilizing the same read set, different assemblers are likely to yield assemblies with varying errors23. Trycycler capitalizes on this variability by constructing a consensus from multiple alternative assemblies of the same genome, enabling it to rectify structural errors, eliminate extraneous contigs, and ensure that circular sequences exhibit no missing or duplicated bases at their termini5. Consequently, we advocate for the utilization of Trycycler in generating long-read bacterial genome assemblies. It is important to note, however, that Trycycler is not an automated tool; it necessitates human judgment and interaction.
This step aims to address any remaining errors by utilizing long reads. It is suggested to utilize Medaka24 for this purpose, as it has been observed to yield more precise outcomes compared to Nanopolish25,26. Medaka operates on a neural network and includes pre-trained models tailored to distinct combinations of ONT chemistry and basecaller. Therefore, it is advisable to select the Medaka model that aligns most closely with the ONT reads being analyzed. Alternatively, long-read variant callers like Clair327 can serve as polishers by integrating the identified variants into the assembly.
Long-read polishing precedes short-read polishing due to its reduced susceptibility to genomic repeats. In this context, a 'repeat' denotes a sequence that leads reads to align erroneously to various positions within the genome. For instance, 150-bp short reads may be encompassed within the rRNA operon, causing them to align to multiple locations and hindering the polishing process by creating repeat regions. Conversely, 20 kbp long reads can span the entire rRNA operon, enabling unique alignment and ensuring that the operon is not considered a repeat. This unique alignment guarantees that polishing corrections are accurately applied to the appropriate sections of the operon.
Long-read polishing typically enhances assembly accuracy, although occasional decreases in accuracy may occur. Consequently, determining the optimal choice between the unpolished assembly, Medaka-polished assembly, or an alternative such as Clair3-polished can be challenging at this stage. ALE serves as a valuable tool for quantifying the agreement between an assembly and a short-read set, enabling researchers to evaluate the comparative accuracy of various assemblies. Therefore, we advocate for the utilization of ALE to inform the decision on which version of the assembly should advance to the subsequent step of short-read polishing.
The preceding procedures have resulted in a long-read-only assembly of high accuracy, estimated to be around ~Q50 (equating to one error per 100 kbp) when utilizing R10.4.1 ONT reads. The ultimate phase involves rectifying any residual errors using short reads. Notably, ONT sequencing may struggle to accurately resolve long homopolymers14, a limitation not encountered with Illumina sequencing12,29. Consequently, homopolymer-length errors that persist post long-read polishing can be rectified through short-read polishing.
Our tool, Polypolish30, was developed with two primary objectives. The first aim was to utilize all-per-read alignments to address the limitations posed by repeats. The second objective was to adopt a highly conservative approach, aiming to minimize the risk of introducing errors during the polishing process. Polypolish strictly adheres to alterations that are unequivocally supported by the read alignments. In cases where there are multiple potential options at a specific locus (such as a base being either A or C with varying alignments supporting each), Polypolish refrains from altering the sequence. Consequently, we recommend executing Polypolish prior to any other short-read polisher for optimal results.
Due to its conservative nature, Polypolish may overlook errors that can be rectified by other short-read polishers, particularly in regions with low Illumina depth. However, it is crucial to note that alternative polishers may inadvertently introduce new errors, a compromise that is deemed unacceptable when striving for perfection. As a recommendation, it is advised to explore other short-read polishers while meticulously evaluating any modifications using a tool like IGV. By examining the read alignments at specific loci before and after polishing, one can ascertain whether a change successfully rectified an error (thus warranting retention) or introduced a new error (prompting rejection). Noteworthy polishers to consider include POLCA, recognized for its minimal error introduction rate, and FMLRC, valued for its capability to rectify errors that elude other polishers.
The method outlined above necessitates human judgment and interaction, especially during the Trycycler and short-read polishing stages. This involvement enables users to identify and rectify any unforeseen outcomes, thereby guaranteeing that erroneous data does not advance to subsequent stages. While this approach is well-suited for tasks where precision is of utmost importance, such as reference genome assembly, it is not conducive to automated execution, as exemplified by Nextflow35, and is consequently unsuitable for high-throughput assembly processes.
If automation is necessary, workflow adjustments become essential. Flye19 stands out as a long-read assembler with a lower likelihood of generating significant errors that downstream polishers might struggle to rectify, positioning it as a viable alternative to Trycycler. Prior to polishing with Medaka, circular Flye contigs should be 'rotated' to a consistent starting sequence (e.g. dnaA36) or a random starting sequence. This rotation facilitates the relocation of any duplicated or missing bases from the beginning or end of circular contigs to the middle of the sequence, where polishing tools can effectively address the errors. For short-read polishing, our recommendation is to utilize Polypolish followed by POLCA, as these tools are associated with a lower risk of error introduction.
Users should not assume that automated assemblies are devoid of errors. Structural errors, such as fragmented replicons or duplicated plasmids, can still occur despite efforts made by tools like Trycycler to prevent them.
Small plasmids (<20 kbp) may be inadequately represented in ONT read sets, potentially due to issues during ligation preparations, such as circular sequences failing to acquire adapters, or overly stringent quality control measures, for instance, discarding all reads <10 kbp. To mitigate this, one could opt for rapid preparations and less strict QC protocols, like only discarding reads <1 kbp. Another approach involves recovering small plasmids from an Illumina-only or short-read-first-hybrid assembly graph, such as those generated by Unicycler, where they typically manifest as circular contigs distinct from the genomic content (see Figure 2A).
Certain bacterial taxa have experienced a proliferation of insertion sequence elements throughout their evolutionary history, leading to genomes containing numerous 1–2 kbp repeats. Achieving a flawless assembly of such genomes poses a significant challenge, as short-read polishers encounter difficulties in rectifying errors within high-copy-number repeats. To address this issue, it is imperative to enhance ONT-only accuracy by maximizing ONT depth, utilizing R10.4.1 pores, employing 'super' basecalling, and implementing Medaka polishing. This approach aims to minimize the number of errors that short-read polishing tools need to rectify. Furthermore, the incorporation of mate-pair Illumina sequencing may facilitate the Polypolish method in correcting errors within repeat sequences by reducing the ambiguity in short-read alignments.
The rRNA operon, spanning approximately 5 kbp, stands as one of the lengthiest repeats found in numerous bacterial genomes, although longer repeats are indeed feasible. A notable instance is observed in Mycobacterium smegmatis mc2155, where a duplication of 56 kbp exists within its chromosome. In scenarios like this, the standard ONT read lengths, averaging around 20 kbp, may prove inadequate for assembly purposes, necessitating the utilization of ultra-long reads, typically extending to approximately 100 kbp, as illustrated in Figure 2C.
Demultiplexing errors may arise during multiplexed sequencing runs, where reads assigned to one barcode can inadvertently spill over into another, leading to a form of low-level contamination. In instances where a sequence within a specific barcode exhibits a notably high depth, it can manifest in other barcodes at levels adequate for assembly. This phenomenon is frequently observed with high-copy-number plasmids, as illustrated in Figure 2D. Therefore, when multiple genome assemblies stemming from the same sequencing run showcase identical plasmids, the potential influence of cross-barcode contamination should be taken into account.
Heterogeneity manifests when there is not a singular underlying genome but rather a blend of two or more alternatives, occurring at varying scales, from small (such as a mix of different bases at a locus) to large (like a blend of structural configurations). At a low level of heterogeneity, where, for instance, 95% of the reads back one sequence and 5% support another, issues are typically avoided as assemblers and polishers tend to favor the more prevalent option. However, when faced with balanced heterogeneity, such as a 50:50 mixture, misassemblies and polishing errors can arise. The phase variation of the fim switch stands as a contributor to heterogeneity in Enterobacteriaceae, as depicted in Figure 2E. Another common instance involves bacteriophages, which have the ability to integrate into and excise from bacterial chromosomes, as illustrated in Figure 2F. Detecting heterogeneity can be achieved through incomplete assembly graphs and dense clusters of changes implemented by a polisher. In such cases, it might become necessary to manually exclude reads supporting one alternative, thereby enabling the other alternative to assemble and polish effectively.
In contrast to previous short-read-first hybrid assembly methods like Unicycler, our proposed approach adheres to a long-read-first paradigm. Long reads, due to their enhanced ability to handle repeats, serve as a robust foundation for assembly, with short reads reserved for final refinement. By adopting this strategy, we posit that achieving flawless genome assemblies devoid of errors is within reach. Nonetheless, establishing an absolute ground truth genome sequence poses challenges, underscoring the importance of conducting multiple alternative assemblies with varying data and methods. This includes exploring different sequencing platforms, assemblers within the Trycycler pipeline, read quality control thresholds, and short-read polishing tools. Consistency in assembly outcomes across diverse data/methods instills confidence in their accuracy. In cases where alternative assemblies diverge, further scrutiny such as visualizing read alignments in IGV becomes imperative.
Although achieving flawless bacterial genome assemblies is now feasible, the process is still complex and not easily attainable. The forthcoming advancements in ONT chemistry, basecallers, and polishers are expected to enhance the assembly quality, yet the question of whether these enhancements will be adequate for achieving flawless ONT-only assemblies, thereby eliminating the necessity for Illumina reads, remains uncertain. Further advancements in software are imperative to eliminate human intervention, facilitating flawless assemblies through a fully automated pipeline, even in intricate scenarios such as genomes with heterogeneity. The ultimate objective is to reach a point in the future where genome assembly to perfection becomes a routine and reliable task, taken for granted.